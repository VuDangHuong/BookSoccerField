<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <title>Trang quáº£n trá»‹ há»‡ thá»‘ng</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    body {
      background-color: #f8f9fa;
    }

    .nav-pills .nav-link.active {
      background-color: #0d6efd;
    }

    .sidebar {
      min-width: 220px;
    }

    .tab-content>.tab-pane {
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>
  <div class="container-fluid mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="text-primary">ğŸ¯ Trang quáº£n trá»‹ há»‡ thá»‘ng</h2>
      <div>
        <span class="me-3 text-muted" id="adminName">Xin chÃ o, Admin</span>
        <button class="btn btn-outline-danger btn-sm" onclick="logout()">ÄÄƒng xuáº¥t</button>
      </div>
    </div>

    <div class="row">
      <!-- Sidebar menu -->
      <div class="col-md-3 sidebar">
        <div class="nav flex-column nav-pills" id="admin-tab" role="tablist" aria-orientation="vertical">
          <button class="nav-link active" id="overview-tab" data-bs-toggle="pill" data-bs-target="#overview"
            type="button">ğŸ“Š Tá»•ng quan</button>
          <button class="nav-link" id="users-tab" data-bs-toggle="pill" data-bs-target="#users" type="button">ğŸ‘¤ Quáº£n lÃ½
            ngÆ°á»i dÃ¹ng</button>
          <button class="nav-link" id="fields-tab" data-bs-toggle="pill" data-bs-target="#fields" type="button">ğŸŸï¸ Quáº£n
            lÃ½ sÃ¢n bÃ³ng</button>
          <button class="nav-link" id="bookings-tab" data-bs-toggle="pill" data-bs-target="#bookings" type="button">ğŸ“…
            Quáº£n lÃ½ Ä‘áº·t lá»‹ch</button>
          <button class="nav-link" id="payments-tab" data-bs-toggle="pill" data-bs-target="#payments" type="button">ğŸ’°
            Quáº£n lÃ½ thanh toÃ¡n</button>
          <button class="nav-link" id="settings-tab" data-bs-toggle="pill" data-bs-target="#settings" type="button">âš™ï¸
            CÃ i Ä‘áº·t</button>
        </div>
      </div>

      <!-- âœ… ÄÃºng: vÃ¹ng ná»™i dung -->
      <div class="col-md-9">
        <div class="tab-content">
          <div class="tab-pane fade show active" id="overview" role="tabpanel">
            <div id="overviewContent">Äang táº£i...</div>
          </div>
          <div class="tab-pane fade" id="users" role="tabpanel">
            <div id="usersContent">Äang táº£i...</div>
          </div>
          <div class="tab-pane fade" id="fields" role="tabpanel">
            <div id="fieldsContent">Äang táº£i...</div>
          </div>
          <div class="tab-pane fade" id="bookings" role="tabpanel">
            <div id="bookingsContent">Äang táº£i...</div>
          </div>
          <div class="tab-pane fade" id="payments" role="tabpanel">
            <div id="paymentsContent">Äang táº£i...</div>
          </div>
          <div class="tab-pane fade" id="settings" role="tabpanel">
            <div id="settingsContent">Äang táº£i...</div>
          </div>
        </div>
      </div>
    </div>


    <!-- Tab content -->

  </div>
  </div>

  <!-- Script -->
  <script>
    async function loadAdminInfo() {
      const token = localStorage.getItem("token");
      if (!token) {
        window.location.href = "/pages/login.html";
        return;
      }

      const res = await fetch("http://localhost:8080/api/admin/users/me", {
        headers: { Authorization: `Bearer ${token}` }
      });

      if (!res.ok) {
        alert("PhiÃªn Ä‘Äƒng nháº­p Ä‘Ã£ háº¿t háº¡n hoáº·c báº¡n khÃ´ng cÃ³ quyá»n.");
        window.location.href = "/pages/login.html";
        return;
      }

      const user = await res.json();
      if (user.role !== "ADMIN") {
        alert("Báº¡n khÃ´ng pháº£i admin.");
        window.location.href = "/";
        return;
      }

      document.getElementById("adminName").innerText = `Xin chÃ o, ${user.name}`;
    }

    function logout() {
      localStorage.removeItem("token");
      window.location.href = "/pages/login.html";
    }
    // Táº£i thÃ´ng tin admin khi trang Ä‘Æ°á»£c táº£i
    const tabMap = {
      //overview: 'overview/page.html',
      users: 'users/page.html',
      //fields: 'fields/page.html',
      //bookings: 'bookings/page.html',
      //payments: 'payments/page.html',
      //settings: 'settings/page.html'
    };

   async function loadTabContent(tabId) {
  const path = tabMap[tabId];
  const targetDiv = document.getElementById(tabId + "Content");
  if (!path || !targetDiv) return;

  try {
    const res = await fetch(path);
    const html = await res.text();
    targetDiv.innerHTML = html;

    // âœ… Load thÃªm file JS náº¿u cÃ³
    const script = document.createElement("script");
    script.src = path.replace(".html", ".js");
    document.body.appendChild(script);

  } catch (err) {
    targetDiv.innerHTML = `<div class="text-danger">KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u.</div>`;
  }
}


    // Tá»± Ä‘á»™ng táº£i khi chuyá»ƒn tab
    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll('.nav-link').forEach(btn => {
        btn.addEventListener("click", () => {
          const tabId = btn.getAttribute("data-bs-target").replace("#", "");
          loadTabContent(tabId);
        });
      });

      // Táº£i tab máº·c Ä‘á»‹nh (overview)
      loadTabContent("overview");
    });
  
  </script>
</body>

</html>